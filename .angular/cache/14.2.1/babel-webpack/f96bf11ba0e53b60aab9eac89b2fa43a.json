{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet VendorMapComponent = class VendorMapComponent {\n  constructor(mapService, el, http, ngZone) {\n    this.mapService = mapService;\n    this.el = el;\n    this.http = http;\n    this.ngZone = ngZone;\n    this.searchAddress = '';\n    this.locationDetail = null;\n  }\n\n  ngOnInit() {\n    // this.mapService.initializeMap(this.el.nativeElement.querySelector('#map'));\n    this.marker = this.mapService.getMarker();\n    this.initAutocomplete();\n    this.subscription = this.mapService.locationNameUpdated.subscribe(locationName => {\n      // console.log(locationName);\n      this.searchAddress = locationName;\n    });\n    this.locDetSubscription = this.mapService.locationDetailUpdated.subscribe(locationDetail => {\n      this.locationDetail = locationDetail;\n    }); // Create infoWindow with a custom content\n\n    this.infoWindow = new google.maps.InfoWindow({\n      content: `\n      <div>\n      <div class=\"text-primary fw-bold mb-2\" style=\"font-size:\n17px\">Your laundry will be picked-up here</div>\n      <div class=\"text-muted\">Please move the map to adjust your location</div>\n       </div>\n      `\n    });\n  }\n\n  ngAfterContentInit() {\n    this.mapService.initializeMap(this.el.nativeElement.querySelector('#map'));\n    this.map = this.mapService.getMap();\n    this.marker = this.mapService.getMarker();\n  }\n\n  getCurrentLocation() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const userLocation = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n        this.mapService.setMapCenter(userLocation.lat, userLocation.lng);\n        this.mapService.setMapZoomLevel(18);\n        this.infoWindow.open(this.map, this.marker);\n      }, error => {\n        console.error('Error getting current location:', error);\n      });\n    } else {\n      console.error('Geolocation is not supported by this browser.');\n    }\n  }\n\n  initAutocomplete() {\n    this.autocomplete = new google.maps.places.Autocomplete(document.getElementById('searchInput'), {\n      types: ['geocode'] // Specify the type of place data to return\n\n    });\n    this.autocomplete.addListener('place_changed', () => {\n      this.ngZone.run(() => {\n        const place = this.autocomplete.getPlace();\n\n        if (place.geometry && place.geometry.location) {\n          // Handle the selected place here\n          // console.log(place);\n          const location = place.geometry.location;\n          this.mapService.setMapCenter(location.lat(), location.lng());\n          this.mapService.setMapZoomLevel(18);\n          this.infoWindow.open(this.map, this.marker);\n        } else {\n          console.error('Invalid place selected:', place);\n        }\n      });\n    });\n  }\n\n  searchPlaces(query) {\n    const placesService = this.mapService.getPlacesService();\n    const request = {\n      query: query,\n      fields: ['name', 'geometry']\n    };\n    placesService.findPlaceFromQuery(request, (results, status) => {\n      if (status === 'OK' && results && results[0].geometry) {\n        const location = results[0].geometry.location;\n        this.mapService.setMapCenter(location.lat(), location.lng());\n      } else {\n        console.error('Error searching for places:', status);\n      }\n    });\n  }\n\n  onSearchInputClick() {\n    // Clear the input field when clicked\n    this.searchAddress = '';\n  } // pickupLocation(){\n  //   if(this.searchAddress && this.locationDetail){\n  //     console.log(this.searchAddress);\n  //   // console.log(this.locationDetail);\n  //   const location = this.getAddressComponents(this.locationDetail);\n  //   console.log(location);\n  //   }\n  // }\n\n\n  pickupLocation() {\n    if (this.searchAddress && this.locationDetail) {\n      const location = this.getAddressComponents(this.locationDetail);\n      console.log(location);\n      this.mapService.storeUserLocation(location).subscribe(userData => {\n        console.log('User Data Stored ', userData);\n      }); //  this.http.post('http://localhost:8082/saveAddress', location).subscribe(x => {console.log(x)})\n    }\n\n    ;\n  }\n\n  getAddressComponents(data) {\n    const result = new UserLocation('', // city\n    '', // country\n    '', // fullAddress\n    0, // latitude\n    0, // longitude\n    '', // pincode\n    '', // state\n    '', // addressType\n    0 // userId\n    ); // const result = {\n    //   fullAddress: '',\n    //   pincode: '',\n    //   city: '',\n    //   state: '',\n    //   country: '',\n    //   lat: 0,\n    //   lng: 0,\n    // }; \n\n    result.fullAddress = data.formatted_address;\n    data.address_components.forEach(component => {\n      const types = component.types;\n\n      if (types.includes('locality')) {\n        result.city = component.long_name;\n      } else if (types.includes('administrative_area_level_1')) {\n        result.state = component.long_name;\n      } else if (types.includes('postal_code')) {\n        result.pincode = component.long_name;\n      } else if (types.includes('country')) {\n        result.country = component.long_name;\n      }\n    });\n    const latLng = this.marker.getPosition(); // Get the marker's position (latitude and longitude)\n\n    result.latitude = latLng.lat(); // Add latitude to the object\n\n    result.longitude = latLng.lng(); // Add longitude to the object\n\n    return result;\n  }\n\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n    this.locDetSubscription.unsubscribe();\n  }\n\n};\n\n__decorate([ViewChild('searchInput')], VendorMapComponent.prototype, \"searchInput\", void 0);\n\nVendorMapComponent = __decorate([Component({\n  selector: 'app-vendor-map',\n  templateUrl: './vendor-map.component.html',\n  styleUrls: ['./vendor-map.component.css']\n})], VendorMapComponent);\nexport { VendorMapComponent };","map":null,"metadata":{},"sourceType":"module"}